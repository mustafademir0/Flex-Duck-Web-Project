<h1 class="'mt-4">Funcionários</h1>
<ol class="breadcrumb mb-4">
    <li class="breadcrumb-item active">Cadastro | Consulta</li>
</ol>

<!-- Abas de Navegação -->
<ul class="nav nav-tabs mb-4">
    <li class="nav-item">
        <a class="nav-link" [class.active]="isTabActive('cadastro')" (click)="setActiveTab('cadastro')">Cadastro</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" [class.active]="isTabActive('consulta')" (click)="setActiveTab('consulta')">Funcionários</a>
    </li>
    <li class="nav-item" [hidden]="true">
        <a class="nav-link" [class.active]="isTabActive('edicao')" (click)="setActiveTab('edicao')">Edição</a>
    </li>
</ul>

<!--NavBar superior (Search+Adicionar)-->

<nav class="navbar navbar-light bg-light justify-content-between w-100" *ngIf="activeTab === 'consulta'">
    <a class="navbar-brand"></a>
    <form class="form-inline mr-auto">
        <input class="form-control mr-sm-2 flex-grow-1" type="search" placeholder="Search" aria-label="Search"
            name="searchText">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit"
            style="margin-right: 5px;">Buscar</button>
        <button class="btn btn-outline-success my-2 my-sm-0" type="button">Limpar</button>
    </form>

    <div class="filter-options">
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inativoCheckbox">
            <label class="form-check-label" for="inativoCheckbox">Inativo</label>
        </div>
    </div>
</nav>

<!--Usuarios renderizam aqui-->
<div class="card mt-4">
    <div class="card-body">

        <div *ngIf="loading" class="spinner-border spinner-border-sm"></div>

<!--Consulta renderiza aqui-->
<table class="table table-condensed table-hover" *ngIf="!loading && activeTab === 'consulta'">
    <thead>
        <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Nome</th>
            <th>Password</th>
            <th>Active</th>
            <th>E-mail</th>
            <th>Crieado em</th>
            <th>Ultimo Acesso</th>
            <th>Level</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let user of users">
            <td>{{ user.user_id }}</td>
            <td>{{ user.username }}</td>
            <td>{{ user.name }}</td>
            <td>{{ user.password }}</td>
            <td>
                <input type="checkbox" *ngIf="user.active" [checked]="true" disabled>
            </td>
            <td>{{ user.email }}</td>
            <td>{{ user.created_at | date:'yyyy-MM-dd HH:mm:ss' }}</td>
            <td>{{ user.last_login | date:'yyyy-MM-dd HH:mm:ss' }}</td>
            <td>{{ user.level }}</td>
            <td>

                <button type="button" class="btn btn-sm btn-outline-info btn-block"
                    (click)="setActiveTab('edicao')">
                    Editar
                </button>

                <button type="button" class="btn btn-sm btn-outline-danger btn-block"
                    *ngIf="currentUser !== user.user_id; else currentUserButton" (click)="deleteUser(user.user_id ? user.user_id : 0)">
                    Deletar
                </button>
                
                <ng-template #currentUserButton>
                    <button type="button" class="btn btn-sm btn-outline-danger btn-block" disabled>
                        Deletar
                    </button>
                </ng-template>


            </td>
        </tr>
    </tbody>
</table>
</div>
</div>
